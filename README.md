# Holdem Auto Trader

## 프로젝트 개요
Holdem Auto Trader는 온라인 홀덤 게임의 자동 매매를 수행하는 Python 기반 봇입니다.  
Chrome DevTools Protocol(CDP)을 활용하여 브라우저를 제어하고, 정해진 전략에 따라 자동으로 입장, 배팅, 방 이동 등을 수행합니다.

## 기능 개요
- **로그인 관리**: 아이디/비밀번호 검증 및 중복 로그인 방지
- **방 탐색 및 입장**: 특정 조건(방 이름 필터, 인원 조건 등)에 맞는 방에 자동 입장
- **게임 결과 분석**: 게임 보드 데이터를 실시간으로 분석하여 결과(P/B/T) 추출
- **Excel 기반 자동 배팅**: 게임 결과를 Excel에 기록하고 내장 수식을 활용한 배팅 전략 실행
  - 첫 입장 시 최근 10개 결과 일괄 기록
  - 이후 새 결과 발생 시 순차적으로 데이터 추가
  - 마지막 열+1의 12행 값(PICK)에 따라 자동 배팅
- **자동 베팅 실행**: P 또는 B에 따라 적절한 베팅 영역을 자동으로 클릭
  - 중복 베팅 방지 시스템 구현
  - 각 게임 라운드마다 한 번만 베팅 실행
- **방 이동 조건**:
  - 배팅에 한 번이라도 성공하면 방 이동
- **자동 로비 복귀**: 게임 조건 충족 시 자동 퇴장 후 새 방 탐색
- **데이터 저장**:
  - 마틴 배팅 수치 저장
  - 전체 목록 체크박스 상태 유지
- **관리자 프로그램**:
  - 유저 관리 (추가, 삭제, 비밀번호 변경, 사용 기간 설정 등)

## 구현된 기능
- [x] 게임방 검색 및 자동 입장
- [x] 게임 결과 실시간 분석
- [x] Excel 파일 연동 및 결과 기록
- [x] Excel 계산 결과에 따른 자동 배팅
- [x] 중복 베팅 방지 시스템
- [x] 환경 설정 관리 (사이트 URL, 마틴 설정 등)
- [x] 방 목록 관리 (저장, 불러오기)
- [x] 마틴 배팅 시스템 구현
- [x] 배팅 성공 시 방 이동 기능 구현
- [x] 관리자 프로그램 개발

## 기술 스택
- **언어**: Python 3.x
- **브라우저 제어**: Chrome DevTools Protocol (CDP), undetected-chromedriver
- **UI**: PyQt6
- **데이터 처리**: Pandas, openpyxl
- **데이터 분석**: BeautifulSoup4
- **데이터 저장**: JSON, SQLite(예정)

## 설치 및 실행 방법
1. 필요 패키지 설치:
```bash
pip install -r requirements.txt
```

2. AUTO.xlsx 파일 준비 (Excel 수식이 포함된 파일)

3. 프로그램 실행:
```bash
python main.py
```

4. 로그인 후 사용법:
   - 사이트 이동 버튼으로 게임 사이트 접속
   - 방 목록 불러오기 후 원하는 방 선택
   - 자동 매매 시작 버튼으로 자동화 실행

## 개발 진행 일정
- **자동 매매 시스템 개발** (완료)
  - 게임 결과 분석
  - Excel 연동
  - 자동 배팅
- **마틴 시스템 개발** (진행 중)
- **테스트 및 개선** (예정)
- **관리자 프로그램 개발** (예정)
- **예상 완료일**: 2025년 3월 24일

## 주의사항
- Windows 환경에서 Excel 저장을 위해 pywin32 라이브러리가 필요합니다.
- Chrome 브라우저가 설치되어 있어야 합니다.
- AUTO.xlsx 파일에는 적절한 예측 수식이 포함되어 있어야 합니다.

## setting_version은 double & half 모드가 셋팅버전으로 돌릴 수 있게 만들었음.

---
